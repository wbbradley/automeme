<head>
	<title></title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
	<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
</head>

<body>
	{{> body}}
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-49199063-1', 'automeme.co');
	  ga('send', 'pageview');

	</script>
</body>

<template name="header">
<header style="background-image: url({{background}})">
		{{#if messagesReady}}
			<section id="send-message">
				{{> send-message}}
			</section>
		{{ else }}
			<h1>{{settings.title}} {{roomName}}</h1>
			{{#with karma}}
				<span class="karma">You have {{ points }} heart point(s).</span>
			{{/with}}
			<div class="clearfix"></div>
		{{/if}}
	</header>
</template>

<template name="body">
	{{> header}}
	{{#if messagesReady}}
		{{> messages}}
	{{/if}}
	<section id="footer">
		<img src="/fortress.png" width="64px">
	</section>
</template>

<template name="weather-report">
<div class="top-login-block">
{{#with weather}}
	{{weather.weather}} / {{feelslike_string}}
{{/with}}
<br/>
</div>
</template>

<template name="currentUserImage">
	<div class="author"></div>
</template>

<template name="messages">
{{#if messages}}
	<section id="messages">
		{{#if newerMessagesExist}}
		<nav class="paging">
			<button onclick="javascript:showNewerMessages()">Show newer messages</button>
		</nav>
		{{/if}}
		{{#each messages}}
			{{> message}}
		{{/each}}
		{{#if olderMessagesExist}}
		<nav class="paging">
			<button onclick="javascript:showOlderMessages()">Show older messages</button>
		</nav>
		{{/if}}
	</section>
{{else}}
	No messages.
{{/if}}
</template>

<template name="send-message">
	<form onsubmit="event.preventDefault();">
		<input type="text" name="new-message" placeholder="Do you even meme?"></input>
		{{#if filepickerEnabled}}
			<button id="btn-file-picker" onclick="javascript:pickFile()">Pick a file</button>
		{{/if}}
		<button name="send">Meme</button>
	</form>
</template>

<template name="memificator">
<div class="meme-container" style="background-image: url({{{imageUrl}}})">
	<div class="inner">
		<div class="top">
			<span contenteditable data-msg-id="{{_id}}" id="meme-{{_id}}-title" class="title meme-text">{{{memeTitle}}}</span><br/>
		</div>
		<div class="bottom">
			<span contenteditable data-msg-id="{{_id}}" id="meme-{{_id}}-subtitle" class="subtitle meme-text">{{{memeSubtitle}}}</span>
		</div>
	</div>
</div>
</template>

<template name="memeDisplay">
<div class="meme-container" style="background-image: url({{{imageUrl}}})">
	<div class="inner">
		<div class="top">
			<span class="title meme-text">{{{memeTitle}}}</span><br/>
		</div>
		<div class="bottom">
			<span class="subtitle meme-text">{{{memeSubtitle}}}</span>
		</div>
	</div>
</div>
</template>

<template name="message">
<div class="message" id="message-{{_id}}">
	<header>
		{{link-render}}
		<nav>
			{{#if ownerOrAdmin}}
				<button class="delete-btn"><i class="fa fa-trash-o"></i></button>
			{{/if}}
			{{#if lovable}}
				<button class="love-btn"><i class="fa fa-heart"></i></button>
			{{/if}}
		</nav>
	</header>
	{{#if meme}}
		{{#ifOwner this}}
			{{> memificator}}
		{{else}}
			{{> memeDisplay}}
		{{/ifOwner}}
	{{else}}
		{{#if msg}}
			<p>{{say msg}}<p>
		{{/if}}
		{{#if imageUrl}}
			<img src="{{{imageUrl}}}" />
		{{/if}}
		{{#if youtube}}
			<iframe id="ytplayer" type="text/html" width="400" height="244" src="http://www.youtube.com/embed/?q={{youtube}}&autoplay=0&origin=http://example.com" frameborder="0"></iframe>
		{{/if}}
	{{/if}}
	<div class="comments">
		{{#loveLoop this}}
			<i class="fa fa-heart"></i>
			{{/loveLoop}}
	</div>
	{{#each comments}}
	<div class="comment">
		<div class="author"></div>
		<div class="name"></div>
		<div class="text">{{text}}</div>
	</div>
	{{/each}}
	<nav class="comment">
		{{> currentUserImage }}
		<nav>
			<button class="comment-btn"><i class="fa fa-comment-o"></i></button>
		</nav>
		<input type="text" name="text">
	</nav>
</div>
</template>
